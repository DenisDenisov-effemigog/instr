<template>
    <div class="sticky-mobile-button" v-if="showButton">
        <div class="sticky-mobile-button__bg"></div>
        <div class="sticky-mobile-button__button"
             :class="{'sticky-mobile-button__button--disabled': disabled}"
        >
            <a v-if="!linkUrl" :href="linkUrl" @click.prevent="closeFilter">
                {{ $tc(titlePartFirst) }} 
                <span class="sticky-mobile-button__text-scnd">{{ currency(items) }}&nbsp;{{ $tc(titlePartSecond, items) }}</span>
            </a>
            <a v-else :href="linkUrl" >
                {{ $tc(titlePartFirst) }} 
                <span class="sticky-mobile-button__text-scnd">{{ currency(items) }}&nbsp;{{ $tc(titlePartSecond, items) }}</span>
            </a>
        </div>
    </div>
    
</template>

<script>
export default {
    name: "sticky-mobile-button",
    props: {
    },
    data(){
        return{
            showButton: false,
            items: 0,
            titlePartFirst: '',
            titlePartSecond: '',
            disabled: false,
            linkUrl: ''
        }
    },
    created() {
        this.$eventBus.$on("sow-button", this.sowButton);
        this.$eventBus.$on("hide-button", this.hideButton);
        this.$eventBus.$on('filter-match', this.quantityMatch);
    },
    methods:{
        sowButton(firstPart, items, secondPart, url) {
            this.showButton = true;
            this.linkUrl = url
            this.disabled = false;
            this.items = Number(items) //передаём количество товаров   
            this.titlePartFirst = firstPart //передаём текст кнопки, который пишется в первом ряду
            this.titlePartSecond = secondPart //передаём текст кнопки, который пишется во втором ряду, не забыть добавить в файл локализаций json варианты pluralization
            if (this.items === 0) {
                this.disabled = true
            }
        },
        hideButton() {
            this.showButton = false
            this.items = 0
            this.titlePartFirst = ''
            this.titlePartSecond = ''
            this.disabled = false
        },
        closeFilter(){
            this.$eventBus.$emit('closeModal')
        },
        quantityMatch(content){
            this.items = content
        }
    }
}
</script>